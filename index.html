<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>5-Wing VR Gallery (Enclosed)</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="ui/ui-blocks.js"></script>
    <script src="ui/ui-painting.js"></script>

    <style>
      body {
        margin: 0;
      }
    </style>
  </head>

  <body>
    <a-scene renderer="antialias:true">
      <a-assets id="assets">
        <img id="floorTex" src="assets/galleryfloor.jpg" crossorigin="anonymous" />

        <!-- Art -->
        <!-- Contemporary / Modern -->
        <img id="cont_abs_01" src="assets/art/abstract1.jpeg" crossorigin="anonymous" />
        <img id="cont_abs_02" src="assets/art/abstract2.jpeg" crossorigin="anonymous" />
        <img id="cont_basquiat_buddha" src="assets/art/basquiatbuddha.jpeg" crossorigin="anonymous" />
        <img id="cont_basquiat_pez" src="assets/art/basquiatpezdispenser.jpeg" crossorigin="anonymous" />
        <img id="cont_basquiat_untitled" src="assets/art/basquiatuntitled.jpg" crossorigin="anonymous" />
        <img id="cont_blaas" src="assets/art/blaas.jpg" crossorigin="anonymous" />
        <img id="cont_mondrian_01" src="assets/art/pietmondrain1.jpg" crossorigin="anonymous" />
        <img id="cont_mondrian_02" src="assets/art/pietmondrain2.jpg" crossorigin="anonymous" />
        <img id="cont_rain_red_dress" src="assets/art/rainingreddress.jpeg" crossorigin="anonymous" />
        <img id="cont_stargazer_collage" src="assets/art/stargazercollage.jpeg" crossorigin="anonymous" />

        <!-- Impressionist -->
        <img id="imp_monet_parasol" src="assets/art/monetparasolwoman.jpeg" crossorigin="anonymous" />
        <img id="imp_monet_lilies" src="assets/art/monetwaterlillies.jpeg" crossorigin="anonymous" />
        <img id="imp_renoir_by_water" src="assets/art/renoirbythewater.jpeg" crossorigin="anonymous" />
        <img id="imp_renoir_layole" src="assets/art/renoirlayole.jpg" crossorigin="anonymous" />
        <img id="imp_renoir_promenade" src="assets/art/renoirpromenade.jpeg" crossorigin="anonymous" />
        <img id="imp_renoir_rose_garden" src="assets/art/renoirrosegarden.jpg" crossorigin="anonymous" />
        <img id="imp_renoir_woman_garden" src="assets/art/renoirwomaningarden.jpg" crossorigin="anonymous" />

        <!-- Post-Impressionist / Symbolist -->
        <img id="postimp_redon_cyclops" src="assets/art/redoncyclops.jpg" crossorigin="anonymous" />
        <img id="postimp_redon_reflection" src="assets/art/redonreflection.jpeg" crossorigin="anonymous" />

        <!-- Renaissance / Classical -->
        <img id="rena_da_vinci_monalisa" src="assets/art/davinchimonalisa.jpeg" crossorigin="anonymous" />
        <img id="rena_da_vinci_ladyermine" src="assets/art/rena_da_vinci_ladyermine.jpg" crossorigin="anonymous" />

        <!-- Rococo -->
        <img id="roco_fragonard_swing" src="assets/art/fragonardtheswing.jpeg" crossorigin="anonymous" />

        <!-- Academic / 19th-century classical -->
        <img id="acad_leighton_accolade" src="assets/art/leightontheaccolade.jpeg" crossorigin="anonymous" />

        <!-- Baroque -->
        <img id="bar_vandyke_cherubs" src="assets/art/vandykecherubs.jpg" crossorigin="anonymous" />
        <img id="bar_vandyke_family" src="assets/art/vandykefamily.jpg" crossorigin="anonymous" />
        <img id="bar_vandyke_head_woman" src="assets/art/vandykeheadofwoman.jpg" crossorigin="anonymous" />

        <!-- Pre-Raphaelite / Romantic narrative -->
        <img id="pre_waterhouse_shalott" src="assets/art/watterhouseshalottlady.jpeg" crossorigin="anonymous" />
        <img id="pre_waterhouse_miranda" src="assets/art/pre_waterhouse_miranda.jpg" crossorigin="anonymous" />
        <img id="pre_waterhouse_souloftherose" src="assets/art/pre_waterhouse_souloftherose.jpg" crossorigin="anonymous" />

        <!-- Figurative / Portrait -->
        <img id="fig_baptiste_head" src="assets/art/baptistehead.jpeg" crossorigin="anonymous" />
        <img id="fig_llanes_poet" src="assets/art/llanesthepoet.jpeg" crossorigin="anonymous" />
        <img id="fig_rossi_boudoir" src="assets/art/rossiboudoir.jpeg" crossorigin="anonymous" />
        <img id="fig_van_gogh_pearlearing" src="assets/art/fig_van_gogh_pearlearing.jpg" crossorigin="anonymous" />

        <!-- Medieval / Religious -->
        <img id="med_st_jerome" src="assets/art/stjerome.jpeg" crossorigin="anonymous" />

        <!-- Bob Ross -->
        <img id="bobross_cedar_park" src="assets/art/newbobrosscedarpark.jpg" crossorigin="anonymous" />
        <img id="bobross_country" src="assets/art/newbobrosscountry.jpg" crossorigin="anonymous" />
        <img id="bobross_mountain_sunset" src="assets/art/newbobrossmountianatsunset.jpeg" crossorigin="anonymous" />
        <img id="bobross_silver_linings" src="assets/art/newbobrosssilverlinings.jpg" crossorigin="anonymous" />

        <!-- Classic / Figurative additions -->
        <img id="dicksee_la_belle_dame" src="assets/art/newdickseelabelledame.jpg" crossorigin="anonymous" />
        <img id="selva_death_of_maiden" src="assets/art/newselvadeathofmaiden.jpg" crossorigin="anonymous" />
        <img id="stevens_lady_and_skull" src="assets/art/newstevensladyandskull.jpg" crossorigin="anonymous" />
        <img id="toulmouche_fiancee" src="assets/art/newtoulmouchefiance.jpg" crossorigin="anonymous" />

        
      </a-assets>

      <a-sky color="#DDE3E8"></a-sky>

      <!-- LIGHTING -->
      <a-entity light="type: ambient; color: #FFF2E3; intensity: 0.28"></a-entity>
      <a-entity
        light="type: directional; color: #FFF2E3; intensity: 0.6; castShadow: true"
        position="6 8 4"
        rotation="-45 35 0"
      ></a-entity>
      <a-entity light="type: hemisphere; skyColor: #FFFFFF; groundColor: #2B2B2B; intensity: 0.35"></a-entity>

      <!-- FLOOR -->
      <a-plane
        rotation="-90 0 0"
        width="140"
        height="140"
        material="src:#floorTex; repeat: 80 80; roughness: 0.7; metalness: 0.0;"
      ></a-plane>

      <a-entity id="world"></a-entity>

      <script>
        function initGallery() {
          const WALL_H = 4.0;
          const WALL_T = 0.55;
          const CEIL_Y = WALL_H;
          const EPS = 0.06;
          const PAINT_INSET = 0.01;

          const world = document.querySelector("#world");

          // ----------------------------
          // ROOM BUILDING
          // ----------------------------
          function wall(x, y, z, w, h, d, rotY = 0) {
            const el = document.createElement("a-box");
            el.setAttribute("position", `${x} ${y} ${z}`);
            el.setAttribute("width", w);
            el.setAttribute("height", h);
            el.setAttribute("depth", d);
            el.setAttribute("rotation", `0 ${rotY} 0`);
            el.setAttribute("material", "color:#EEEEEE; roughness:0.9; metalness:0.0;");
            world.appendChild(el);
            return el;
          }

          function ceiling(x, z, w, d) {
            const el = document.createElement("a-plane");
            el.setAttribute("position", `${x} ${CEIL_Y} ${z}`);
            el.setAttribute("rotation", "90 0 0");
            el.setAttribute("width", w);
            el.setAttribute("height", d);
            el.setAttribute("material", "color:#FFFFFF; roughness:1.0; metalness:0.0; side:double;");
            world.appendChild(el);
            return el;
          }

          function buildRoom({ xMin, xMax, zMin, zMax, doors = [], ceil = true }) {
            const y = WALL_H / 2;
            const W = xMax - xMin;
            const D = zMax - zMin;

            const bySide = { north: [], south: [], east: [], west: [] };
            doors.forEach((d) => bySide[d.side].push(d));

            function segmentsOnWall(side) {
              const segs = [];

              if (side === "north" || side === "south") {
                const fixedZ = side === "north" ? zMin : zMax;
                const doorList = (bySide[side] || []).slice().sort((a, b) => a.center - b.center);

                let cursor = xMin;
                doorList.forEach((door) => {
                  const doorL = door.center - door.width / 2;
                  const doorR = door.center + door.width / 2;
                  if (doorL > cursor) segs.push({ x1: cursor, x2: doorL, z: fixedZ });
                  cursor = Math.max(cursor, doorR);
                });
                if (cursor < xMax) segs.push({ x1: cursor, x2: xMax, z: fixedZ });

                segs.forEach((s) => {
                  const segW = s.x2 - s.x1 + EPS;
                  const cx = (s.x1 + s.x2) / 2;
                  const cz = side === "north" ? s.z - WALL_T / 2 : s.z + WALL_T / 2;
                  wall(cx, y, cz, segW, WALL_H, WALL_T, 0);
                });
              } else {
                const fixedX = side === "west" ? xMin : xMax;
                const doorList = (bySide[side] || []).slice().sort((a, b) => a.center - b.center);

                let cursor = zMin;
                doorList.forEach((door) => {
                  const doorL = door.center - door.width / 2;
                  const doorR = door.center + door.width / 2;
                  if (doorL > cursor) segs.push({ z1: cursor, z2: doorL, x: fixedX });
                  cursor = Math.max(cursor, doorR);
                });
                if (cursor < zMax) segs.push({ z1: cursor, z2: zMax, x: fixedX });

                segs.forEach((s) => {
                  const segD = s.z2 - s.z1 + EPS;
                  const cz = (s.z1 + s.z2) / 2;
                  const cx = side === "west" ? s.x - WALL_T / 2 : s.x + WALL_T / 2;
                  wall(cx, y, cz, WALL_T, WALL_H, segD, 0);
                });
              }
            }

            segmentsOnWall("north");
            segmentsOnWall("south");
            segmentsOnWall("west");
            segmentsOnWall("east");

            if (ceil) {
              ceiling((xMin + xMax) / 2, (zMin + zMax) / 2, W, D);
            }

            const light = document.createElement("a-entity");
            light.setAttribute(
              "light",
              "type: spot; color: #FFE6C9; intensity: 0.9; angle: 60; penumbra: 0.6; distance: 30"
            );
            light.setAttribute("position", `${(xMin + xMax) / 2} 3.9 ${(zMin + zMax) / 2}`);
            light.setAttribute("rotation", "-90 0 0");
            world.appendChild(light);
          }

          // Build rooms
          buildRoom({
            xMin: -10,
            xMax: 10,
            zMin: -10,
            zMax: 10,
            doors: [
              { side: "north", center: 0, width: 6 },
              { side: "south", center: 0, width: 6 },
              { side: "east", center: 0, width: 6 },
              { side: "west", center: 0, width: 6 },
              { side: "north", center: 10, width: 6 },
            ],
            ceil: true,
          });

          buildRoom({
            xMin: -9,
            xMax: 9,
            zMin: -34,
            zMax: -10,
            doors: [
              { side: "south", center: 0, width: 6 },
              { side: "south", center: 7, width: 5 },
            ],
            ceil: true,
          });

          buildRoom({
            xMin: -9,
            xMax: 9,
            zMin: 10,
            zMax: 34,
            doors: [{ side: "north", center: 0, width: 6 }],
            ceil: true,
          });

          buildRoom({
            xMin: 10,
            xMax: 34,
            zMin: -9,
            zMax: 9,
            doors: [
              { side: "west", center: 0, width: 6 },
              { side: "north", center: 22, width: 10 },
            ],
            ceil: true,
          });

          buildRoom({
            xMin: -34,
            xMax: -10,
            zMin: -9,
            zMax: 9,
            doors: [{ side: "east", center: 0, width: 6 }],
            ceil: true,
          });

          buildRoom({
            xMin: 10,
            xMax: 30,
            zMin: -32,
            zMax: -9,
            doors: [{ side: "south", center: 22, width: 10 }],
            ceil: true,
          });

          // Room bounds
          const HUB = { xMin: -10, xMax: 10, zMin: -10, zMax: 10 };
          const NORTH = { xMin: -9, xMax: 9, zMin: -34, zMax: -10 };
          const SOUTH = { xMin: -9, xMax: 9, zMin: 10, zMax: 34 };
          const EAST = { xMin: 10, xMax: 34, zMin: -9, zMax: 9 };
          const WEST = { xMin: -34, xMax: -10, zMin: -9, zMax: 9 };
          const NE = { xMin: 10, xMax: 30, zMin: -32, zMax: -9 };

          // ----------------------------
          // PAINTINGS
          // ----------------------------
          VRWPaintings.init({
            world,
            bounds: { HUB, NORTH, SOUTH, EAST, WEST, NE },
            paintInset: PAINT_INSET,
            options: {
              enableHoverHighlight: true,
              enableUILogging: true,
            },
          });
        }

        const sceneEl = document.querySelector("a-scene");
        sceneEl.addEventListener("loaded", initGallery, { once: true });
      </script>

      <!-- control with cursor for testing -->
      <a-camera position="0 1.6 0" look-controls>
        <a-entity cursor="rayOrigin: mouse" raycaster="objects: .clickable"></a-entity>
      </a-camera>

      <!-- controll rays for headset -->
      <a-entity laser-controls="hand: left" raycaster="objects: .clickable"></a-entity>
      <a-entity laser-controls="hand: right" raycaster="objects: .clickable"></a-entity>
      <a-entity ui-block></a-entity>

      <!-- check in nudge panel -->
      <a-entity id="checkInPanel" position="0 1.35 -1.45" visible="false">
        <a-plane width="3.4" height="1.1" position="0 -0.025 -0.01" material="color:#000; opacity:0.15; transparent:true;"></a-plane>
        <a-plane width="3.32" height="1.02" position="0 0 -0.005" material="color:#FFFFFF; opacity:0.4; transparent:true;"></a-plane>
        <a-plane width="3.24" height="0.94" position="0 0 0" material="color:#F5F1E8; opacity:0.35; transparent:true;"></a-plane>

        <a-text value="rate your level of comfort" position="-1.48 0.32 0.01" width="3.0" color="#111111"
          font="https://cdn.aframe.io/fonts/Roboto-msdf.json"></a-text>

        <a-text value="1 = not comfortable  â€¢  5 = very comfortable" position="-1.48 0.18 0.01" width="3.0" color="#6B7280"
          font="https://cdn.aframe.io/fonts/Roboto-msdf.json"></a-text>

        <a-entity position="0 -0.14 0.02">
          <a-entity position="-0.84 0 0">
            <a-circle id="comfortBtn1" class="clickable" radius="0.15" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-circle>
            <a-entity position="0 0 0.02"
              text="value: 1; align: center; anchor: center; baseline: center; width: 2.5; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>
          <a-entity position="-0.42 0 0">
            <a-circle id="comfortBtn2" class="clickable" radius="0.15" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-circle>
            <a-entity position="0 0 0.02"
              text="value: 2; align: center; anchor: center; baseline: center; width: 2.5; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>
          <a-entity position="0 0 0">
            <a-circle id="comfortBtn3" class="clickable" radius="0.15" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-circle>
            <a-entity position="0 0 0.02"
              text="value: 3; align: center; anchor: center; baseline: center; width: 2.5; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>
          <a-entity position="0.42 0 0">
            <a-circle id="comfortBtn4" class="clickable" radius="0.15" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-circle>
            <a-entity position="0 0 0.02"
              text="value: 4; align: center; anchor: center; baseline: center; width: 2.5; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>
          <a-entity position="0.84 0 0">
            <a-circle id="comfortBtn5" class="clickable" radius="0.15" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-circle>
            <a-entity position="0 0 0.02"
              text="value: 5; align: center; anchor: center; baseline: center; width: 2.5; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>
        </a-entity>
      </a-entity>

      <!-- break prompt panel -->
      <a-entity id="breakPromptPanel" position="0 1.35 -1.45" visible="false">
        <a-plane width="3.4" height="1.1" position="0 -0.025 -0.01" material="color:#000; opacity:0.15; transparent:true;"></a-plane>
        <a-plane width="3.32" height="1.02" position="0 0 -0.005" material="color:#FFFFFF; opacity:0.4; transparent:true;"></a-plane>
        <a-plane width="3.24" height="0.94" position="0 0 0" material="color:#F5F1E8; opacity:0.35; transparent:true;"></a-plane>

        <a-text value="would you like to take a short break?" position="-1.48 0.20 0.01" width="3.0" color="#111111"
          font="https://cdn.aframe.io/fonts/Roboto-msdf.json"></a-text>

        <a-entity position="0 -0.18 0.02">
          <a-entity position="-0.68 0 0">
            <a-plane id="breakYesBtn" class="clickable" width="1.15" height="0.28" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-plane>
            <a-entity position="0 0 0.01"
              text="value: Take break; align: center; anchor: center; baseline: center; width: 2.0; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>

          <a-entity position="0.68 0 0">
            <a-plane id="breakNoBtn" class="clickable" width="1.15" height="0.28" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-plane>
            <a-entity position="0 0 0.01"
              text="value: Keep going; align: center; anchor: center; baseline: center; width: 2.0; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
          </a-entity>
        </a-entity>
      </a-entity>

      <!-- break message panel -->
      <a-entity id="breakMessagePanel" position="0 1.35 -1.45" visible="false">
        <a-plane width="3.4" height="1.1" position="0 -0.025 -0.01" material="color:#000; opacity:0.15; transparent:true;"></a-plane>
        <a-plane width="3.32" height="1.02" position="0 0 -0.005" material="color:#FFFFFF; opacity:0.4; transparent:true;"></a-plane>
        <a-plane width="3.24" height="0.94" position="0 0 0" material="color:#F5F1E8; opacity:0.35; transparent:true;"></a-plane>

        <a-text value="Break time" position="-1.48 0.28 0.01" width="3.0" color="#111111"
          font="https://cdn.aframe.io/fonts/Roboto-msdf.json"></a-text>

        <a-text value="Remove the headset for 60 seconds." position="-1.48 0.14 0.01" width="3.0" color="#6B7280"
          font="https://cdn.aframe.io/fonts/Roboto-msdf.json"></a-text>

        <a-entity position="0 -0.18 0.02">
          <a-circle id="breakOkBtn" class="clickable" radius="0.15" material="color:#FFFFFF; opacity:0.75; transparent:true;"></a-circle>
          <a-entity position="0 0 0.02"
            text="value: OK; align: center; anchor: center; baseline: center; width: 2.0; color: #111; font: https://cdn.aframe.io/fonts/Roboto-msdf.json;"></a-entity>
        </a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
